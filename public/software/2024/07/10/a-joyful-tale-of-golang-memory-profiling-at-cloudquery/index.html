<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Mariano Gappa's Blog</title>
<link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/chroma.css><link rel=icon href=/favicon.ico></head><body><header><div class=container><h1 class=site-title><a href=/>Mariano Gappa's Blog</a></h1><nav><ul><li><a href=/about/>About</a></li><li><a href=/projects/>Projects</a></li></ul></nav></div></header><main class=container><article class=post><div class=post-meta><span class=post-date>Jul 10, 2024</span></div><h1 class=post-title>A Joyful Tale of Golang Memory Profiling at CloudQuery</h1><div class=post-content><p>Profiling memory in Go can be joyful! Here&rsquo;s a quick example:</p><p><img src=/images/posts/golang-memory.png alt="Golang Memory Profiling"></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;runtime/pprof&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#e6db74>&#34;mem.prof&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>GC</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>pprof</span>.<span style=color:#a6e22e>WriteHeapProfile</span>(<span style=color:#a6e22e>f</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Close</span>()
</span></span></code></pre></div><p>This led to an 84% reduction in memory usage at CloudQuery.</p></div></article></main></body></html>